from docutils import nodes
from docutils.parsers.rst import Directive


class compatibility(Directive):

    def run(self):
        text = 'Added: mIRC v'
        version = self.arguments[0].strip()
        p = text + version + ' (' + version2date(version) + ')'
        paragraph_node = nodes.paragraph(text=p)
        return [paragraph_node]

    def version2date(x):
        return {
            '7.73' = 'Date TBD'
            '7.72' = '27 nov 2022'
            '7.71' = '01 oct 2022'
            '7.69' = '18 jul 2022'
            '7.68' = '02 apr 2022'
            '7.67' = '02 oct 2021'
            '7.66' = '29 jun 2021'
            '7.65' = '07 may 2021'
            '7.64' = '11 dec 2020'
            '7.63' = '17 aug 2020'
            '7.62' = '29 jul 2020'
            '7.61' = '01 mar 2020'
            '7.59' = '08 feb 2020'
            '7.58' = '17 nov 2019'
            '7.57' = '27 jul 2019'
            '7.56' = '06 jul 2019'
            '7.55' = '08 feb 2019'
            '7.54' = '21 dec 2018'
            '7.53' = '29 nov 2018'
            '7.52' = '28 feb 2018'
            '7.51' = '18 sep 2017'
            '7.49' = '25 may 2017'
            '7.48' = '15 apr 2017'
            '7.47' = '18 jan 2017'
            '7.46' = '01 aug 2016'
            '7.45' = '25 apr 2016'
            '7.44' = '25 mar 2016'
            '7.43' = '03 aug 2015'
            '7.42' = '17 jul 2015'
            '7.41' = '28 feb 2015'
            '7.39' = '28 jan 2015'
            '7.38' = '27 nov 2014'
            '7.37' = '07 nov 2014'
            '7.36' = '14 aug 2014'
            '7.35' = '04 aug 2014'
            '7.34' = '18 jun 2014'
            '7.33' = '27 may 2014'
            '7.32' = '23 may 2013'
            '7.31' = '26 apr 2013'
            '7.29' = '16 jan 2013'
            '7.28' = '08 dec 2012'
            '7.27' = '20 oct 2012'
            '7.26' = '03 oct 2012'
            '7.25' = '13 jun 2012'
            '7.24' = '26 may 2012'
            '7.23' = '19 mar 2012'
            '7.22' = '13 oct 2011'
            '7.21' = '08 oct 2011'
            '7.19' = '07 mar 2011'
            '7.18' = '24 feb 2011'
            '7.17' = '17 dec 2010'
            '7.16' = '30 nov 2010'
            '7.15' = '08 nov 2010'
            '7.14' = '13 oct 2010'
            '7.12' = '29 sep 2010'
            '7.11' = '08 sep 2010'
            '7.1' = '30 jul 2010'
            '7.08' = '21 jul 2010'
            '7.07' = '09 jul 2010'
            '7.06' = '28 jun 2010'
            '7.05' = '16 jun 2010'
            '7.04' = '28 may 2010'
            '7.03' = '20 may 2010'
            '7.02' = '01 may 2010'
            '7.01' = '15 apr 2010'
            '7.0' = '02 apr 2010'
            '6.35' = '17 oct 2008'
            '6.34' = '08 aug 2008'
            '6.33' = '18 jul 2008'
            '6.32' = '21 may 2008'
            '6.31' = '01 nov 2007'
            '6.3' = '16 aug 2007'
            '6.21' = '23 nov 2006'
            '6.2' = '28 jul 2006'
            '6.17' = '17 feb 2006'
            '6.16' = '07 jul 2004'
            '6.15' = '03 jun 2004'
            '6.14' = '03 mar 2004'
            '6.12' = '13 oct 2003'
            '6.11' = '10 oct 2003'
            '6.1' = '29 aug 2003'
            '6.03' = '16 aug 2002'
            '6.02' = '06 jun 2002'
            '6.01' = '10 feb 2002'
            '6.0' = '03 feb 2002'
            '5.91' = '15 jun 2001'
            '5.9' = '26 apr 2001'
            '5.82' = '14 dec 2000'
            '5.81' = '09 nov 2000'
            '5.8' = '05 sep 2000'
            '5.71' = '07 may 2000'
            '5.7' = '02 feb 2000'
            '5.61' = '23 sep 1999'
            '5.6' = '03 jun 1999'
            '5.51' = '19 feb 1999'
            '5.5' = '08 jan 1999'
            '5.41' = '24 jul 1998'
            '5.4' = '23 jun 1998'
            '5.31' = '04 jan 1998'
            '5.3' = '13 dec 1997'
            '5.11' = '11 sep 1997'
            '5.1' = '28 aug 1997'
            '5.02' = '21 apr 1997'
            '5.0' = '02 apr 1997'
            '4.72' = '09 jan 1997'
            '4.7' = '09 dec 1996'
            '4.6' = '07 sep 1996'
            '4.52' = '06 jul 1996'
            '4.5' = '30 jun 1996'
            '4.1' = '27 apr 1996'
            '4.0' = '20 mar 1996'
            '3.92' = '06 jan 1996'
            '3.9' = '28 dec 1995'
            '3.8' = '25 nov 1995'
            '3.72' = '24 oct 1995'
            '3.7' = '12 oct 1995'
            '3.64' = '13 sep 1995'
            '3.64' = '11 sep 1995'
            '3.6' = '31 aug 1995'
            '3.51' = '13 aug 1995'
            '3.5' = '07 aug 1995'
            '3.42' = '29 jun 1995'
            '3.4' = '21 jun 1995'
            '3.3' = '21 jun 1995'
            '3.2' = '02 may 1995'
            '3.1' = '23 apr 1995'
            '2.8' = '26 mar 1995'
            '2.8' = '21 mar 1995'
            '2.7' = '18 mar 1995'
            '2.6' = '13 mar 1995'
            '2.5' = '08 mar 1995'
            '2.4' = '05 mar 1995'
            '2.3' = '02 mar 1995'
            '2.1' = '28 feb 1995'
        }.get(x, 'Cannot find date for version: ' + x + ' in function!')

def setup(app):
    app.add_directive("mirckb_compat", compatibility)

    return {
        'version': '0.1',
        'parallel_read_safe': True,
        'parallel_write_safe': True,
    }