from docutils import nodes
from docutils.parsers.rst import Directive

class compatibility(Directive):
    
    required_arguments = 1
    has_content = False
    final_argument_whitespace = False

    def run(self):
        paragraph_node = nodes.paragraph(text='Added: mIRC v' + self.arguments[0] + ' (' + version2date(self.arguments[0]) + ')')
        return [paragraph_node]

def version2date(x):
    return {
        "7.76": "Date TBD",
        "7.75": "26 Aug 2023",
        "7.74": "02 Aug 2023",
        "7.73": "18 Jun 2023",
        "7.72": "27 Nov 2022",
        "7.71": "01 Oct 2022",
        "7.69": "18 Jul 2022",
        "7.68": "02 Apr 2022",
        "7.67": "02 Oct 2021",
        "7.66": "29 Jun 2021",
        "7.65": "07 May 2021",
        "7.64": "11 Dec 2020",
        "7.63": "17 Aug 2020",
        "7.62": "29 Jul 2020",
        "7.61": "01 Mar 2020",
        "7.59": "08 Feb 2020",
        "7.58": "17 Nov 2019",
        "7.57": "27 Jul 2019",
        "7.56": "06 Jul 2019",
        "7.55": "08 Feb 2019",
        "7.54": "21 Dec 2018",
        "7.53": "29 Nov 2018",
        "7.52": "28 Feb 2018",
        "7.51": "18 Sep 2017",
        "7.49": "25 May 2017",
        "7.48": "15 Apr 2017",
        "7.47": "18 Jan 2017",
        "7.46": "01 Aug 2016",
        "7.45": "25 Apr 2016",
        "7.44": "25 Mar 2016",
        "7.43": "03 Aug 2015",
        "7.42": "17 Jul 2015",
        "7.41": "28 Feb 2015",
        "7.39": "28 Jan 2015",
        "7.38": "27 Nov 2014",
        "7.37": "07 Nov 2014",
        "7.36": "14 Aug 2014",
        "7.35": "04 Aug 2014",
        "7.34": "18 Jun 2014",
        "7.33": "27 May 2014",
        "7.32": "23 May 2013",
        "7.31": "26 Apr 2013",
        "7.29": "16 Jan 2013",
        "7.28": "08 Dec 2012",
        "7.27": "20 Oct 2012",
        "7.26": "03 Oct 2012",
        "7.25": "13 Jun 2012",
        "7.24": "26 May 2012",
        "7.23": "19 Mar 2012",
        "7.22": "13 Oct 2011",
        "7.21": "08 Oct 2011",
        "7.19": "07 Mar 2011",
        "7.18": "24 Feb 2011",
        "7.17": "17 Dec 2010",
        "7.16": "30 Nov 2010",
        "7.15": "08 Nov 2010",
        "7.14": "13 Oct 2010",
        "7.12": "29 Sep 2010",
        "7.11": "08 Sep 2010",
        "7.1": "30 Jul 2010",
        "7.08": "21 Jul 2010",
        "7.07": "09 Jul 2010",
        "7.06": "28 Jun 2010",
        "7.05": "16 Jun 2010",
        "7.04": "28 May 2010",
        "7.03": "20 May 2010",
        "7.02": "01 May 2010",
        "7.01": "15 Apr 2010",
        "7.0": "02 Apr 2010",
        "6.35": "17 Oct 2008",
        "6.34": "08 Aug 2008",
        "6.33": "18 Jul 2008",
        "6.32": "21 May 2008",
        "6.31": "01 Nov 2007",
        "6.3": "16 Aug 2007",
        "6.21": "23 Nov 2006",
        "6.2": "28 Jul 2006",
        "6.17": "17 Feb 2006",
        "6.16": "07 Jul 2004",
        "6.15": "03 Jun 2004",
        "6.14": "03 Mar 2004",
        "6.12": "13 Oct 2003",
        "6.11": "10 Oct 2003",
        "6.1": "29 Aug 2003",
        "6.03": "16 Aug 2002",
        "6.02": "06 Jun 2002",
        "6.01": "10 Feb 2002",
        "6.0": "03 Feb 2002",
        "5.91": "15 Jun 2001",
        "5.9": "26 Apr 2001",
        "5.82": "14 Dec 2000",
        "5.81": "09 Nov 2000",
        "5.8": "05 Sep 2000",
        "5.71": "07 May 2000",
        "5.7": "02 Feb 2000",
        "5.61": "23 Sep 1999",
        "5.6": "03 Jun 1999",
        "5.51": "19 Feb 1999",
        "5.5": "08 Jan 1999",
        "5.41": "24 Jul 1998",
        "5.4": "23 Jun 1998",
        "5.31": "04 Jan 1998",
        "5.3": "13 Dec 1997",
        "5.11": "11 Sep 1997",
        "5.1": "28 Aug 1997",
        "5.02": "21 Apr 1997",
        "5.0": "02 Apr 1997",
        "4.72": "09 Jan 1997",
        "4.7": "09 Dec 1996",
        "4.6": "07 Sep 1996",
        "4.52": "06 Jul 1996",
        "4.5": "30 Jun 1996",
        "4.1": "27 Apr 1996",
        "4.0": "20 Mar 1996",
        "3.92": "06 Jan 1996",
        "3.9": "28 Dec 1995",
        "3.8": "25 Nov 1995",
        "3.72": "24 Oct 1995",
        "3.7": "12 Oct 1995",
        "3.64": "13 Sep 1995",
        "3.64": "11 Sep 1995",
        "3.6": "31 Aug 1995",
        "3.51": "13 Aug 1995",
        "3.5": "07 Aug 1995",
        "3.42": "29 Jun 1995",
        "3.4": "21 Jun 1995",
        "3.3": "21 Jun 1995",
        "3.2": "02 May 1995",
        "3.1": "23 Apr 1995",
        "2.8": "26 Mar 1995",
        "2.8": "21 Mar 1995",
        "2.7": "18 Mar 1995",
        "2.6": "13 Mar 1995",
        "2.5": "08 Mar 1995",
        "2.4": "05 Mar 1995",
        "2.3": "02 Mar 1995",
        "2.1a": "28 Feb 1995",
        "2.1": "28 Feb 1995"
    }.get(x, "Cannot find date for version: " + x + " in function!")

def setup(app):
    app.add_directive("compatibility", compatibility)

    return {
        'version': '0.1',
        'parallel_read_safe': True,
        'parallel_write_safe': True,
    }